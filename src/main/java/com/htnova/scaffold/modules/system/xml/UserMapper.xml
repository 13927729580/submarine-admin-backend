<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.htnova.scaffold.modules.system.mapper.UserMapper">

    <sql id="SelectColumns">
        a.id,
        a.username,
        a.password,
        a.name,
        a.phone,
        a.email,
        a.address,
        a.sex,
        a.avatar,
        a.status,
        a.dept_id,
        a.dept_ids,
        a.dept_name,
        a.jwt_secret,
        a.remark,
        a.create_by,
        a.create_time,
        a.update_by,
        a.update_time,
        a.del_flag
    </sql>

    <!--列表查询-->
    <sql id="findList">
        SELECT
            <include refid="SelectColumns"/>
        FROM user a WHERE a.del_flag = #{user.delFlag}
        <if test="user.id != null and user.id != ''">
            AND a.id = #{user.id}
        </if>
        <if test="user.username != null and user.username != ''">
            AND a.username LIKE concat('%',#{user.username},'%')
        </if>
        <!--<if test="user.password != null and user.password != ''">-->
            <!--AND a.password = #{user.password}-->
        <!--</if>-->
        <if test="user.name != null and user.name != ''">
            AND a.name LIKE concat('%',#{user.name},'%')
        </if>
        <if test="user.phone != null and user.phone != ''">
            AND a.phone LIKE concat('%',#{user.phone},'%')
        </if>
        <if test="user.email != null and user.email != ''">
            AND a.email LIKE concat('%',#{user.email},'%')
        </if>
        <if test="user.address != null and user.address != ''">
            AND a.address LIKE concat('%',#{user.address},'%')
        </if>
        <if test="user.sex != null and user.sex != ''">
            AND a.sex = #{user.sex}
        </if>
        <if test="user.avatar != null and user.avatar != ''">
            AND a.avatar = #{user.avatar}
        </if>
        <if test="user.status != null and user.status != ''">
            AND a.status = #{user.status}
        </if>
        <if test="user.deptId != null and user.deptId != ''">
            AND a.dept_id = #{user.deptId}
        </if>
        <if test="user.deptIds != null and user.deptIds != ''">
            AND a.dept_ids LIKE concat('%',#{user.deptIds},'%')
        </if>
        <if test="user.deptName != null and user.deptName != ''">
            AND a.dept_name LIKE concat('%',#{user.deptName},'%')
        </if>
        <if test="user.jwtSecret != null and user.jwtSecret != ''">
            AND a.jwt_secret = #{user.jwtSecret}
        </if>
        <if test="user.remark != null and user.remark != ''">
            AND a.remark LIKE concat('%',#{user.remark},'%')
        </if>
        <if test="user.createBy != null and user.createBy != ''">
            AND a.create_by = #{user.createBy}
        </if>
        <if test="user.createTime != null and user.createTime != ''">
            AND a.create_time = #{user.createTime}
        </if>
        <if test="user.updateBy != null and user.updateBy != ''">
            AND a.update_by = #{user.updateBy}
        </if>
        <if test="user.updateTime != null and user.updateTime != ''">
            AND a.update_time = #{user.updateTime}
        </if>
    </sql>

    <!--分页查询-->
    <select id="findPage" resultType="User">
        <include refid="findList"/>
    </select>

    <!--列表查询-->
    <select id="findList" resultType="User">
        <include refid="findList"/>
    </select>

</mapper>

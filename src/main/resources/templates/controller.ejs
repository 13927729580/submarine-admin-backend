package <%= package %>.modules.<%= module %>.controller;

import <%= package %>.common.dto.Result;
import <%= package %>.common.dto.XPage;
import <%= package %>.common.util.CommonUtil;
import <%= package %>.modules.<%= module %>.mapstruct.<%= Entity %>MapStruct;
import <%= package %>.modules.<%= module %>.dto.<%= Entity %>Dto;
import <%= package %>.modules.<%= module %>.entity.<%= Entity %>;
import <%= package %>.modules.<%= module %>.service.<%= Entity %>Service;
import org.springframework.web.bind.annotation.*;

import javax.annotation.Resource;
import java.util.List;

/**
 * @menu <%= entityZh %>
 */
@RestController
@RequestMapping("/<%= entity %>")
public class <%= Entity %>Controller {

    @Resource
    private <%= Entity %>Service <%= entity %>Service;

    /**
     * 分页查询
     */
    @PreAuthorize("hasAnyAuthority('<%= entity %>', '<%= entity %>.find')")
    @GetMapping("/list/page")
    public XPage<<%= Entity %>Dto> findListByPage(<%= Entity %>Dto <%= entity %>Dto, XPage xPage) {
        XPage<<%= Entity %>> <%= entity %>Page = <%= entity %>Service.find<%= Entity %>List(<%= entity %>Dto.toEntity(), xPage);
        return <%= entity %>Page.toDto();
    }

    /**
     * 查询
     */
    @PreAuthorize("hasAnyAuthority('<%= entity %>', '<%= entity %>.find')")
    @GetMapping("/list/all")
    public List<<%= Entity %>Dto> findList(<%= Entity %>Dto <%= entity %>Dto) {
        List<<%= Entity %>> <%= entity %>List = <%= entity %>Service.find<%= Entity %>List(<%= entity %>Dto.toEntity());
        return CommonUtil.toDto(<%= entity %>List, <%= Entity %>MapStruct.class);
    }

    /**
     * 详情
     */
    @PreAuthorize("hasAnyAuthority('<%= entity %>', '<%= entity %>.find')")
    @GetMapping("/detail")
    public <%= Entity %>Dto getById(long id) {
        <%= Entity %> <%= entity %> = <%= entity %>Service.get<%= Entity %>ById(id);
        return <%= entity %>.toDto();
    }

    /**
     * 保存
     */
    @PreAuthorize("hasAnyAuthority('<%= entity %>', '<%= entity %>.add', '<%= entity %>.edit')")
    @PostMapping("/save")
    public Result save(<%= Entity %>Dto <%= entity %>Dto) {
        <%= entity %>Service.save<%= Entity %>(<%= entity %>Dto.toEntity());
        return Result.successMsg("保存成功");
    }

    /**
     * 删除
     */
    @PreAuthorize("hasAnyAuthority('<%= entity %>', '<%= entity %>.del')")
    @DeleteMapping("/del")
    public Result delete(<%= Entity %>Dto <%= entity %>Dto) {
        <%= entity %>Service.delete<%= Entity %>(<%= entity %>Dto.getId());
        return Result.successMsg("删除成功");
    }
}
